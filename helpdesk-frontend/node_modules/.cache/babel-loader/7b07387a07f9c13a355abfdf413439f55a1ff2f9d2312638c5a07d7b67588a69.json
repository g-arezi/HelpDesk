{"ast":null,"code":"var _jsxFileName = \"E:\\\\Helpdesk\\\\HelpDesk\\\\helpdesk-frontend\\\\src\\\\components\\\\TicketList.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport './TicketList.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst statusOptions = [{\n  value: 'nao_aberto',\n  label: 'Não aberto'\n}, {\n  value: 'em_analise',\n  label: 'Em análise'\n}, {\n  value: 'resolvido',\n  label: 'Resolvido'\n}];\nconst TicketList = ({\n  onSelect,\n  onStatusChange\n}) => {\n  _s();\n  const [tickets, setTickets] = useState([]);\n  const [updating, setUpdating] = useState(null);\n  const [feedback, setFeedback] = useState(null);\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_API_URL}/tickets_api.php`, {\n      credentials: 'include'\n    }).then(res => {\n      if (!res.ok) throw new Error('Erro ao buscar tickets');\n      return res.json();\n    }).then(data => {\n      const mapped = (data || []).map((t, idx) => {\n        let status = t.status;\n        if (!status || status === 'Desconhecido') status = 'nao_aberto';\n        return {\n          id: idx + 1,\n          title: t.subject || t.title || 'Sem título',\n          status,\n          name: t.name,\n          email: t.email,\n          subject: t.subject,\n          message: t.message,\n          telefone: t.telefone\n        };\n      });\n      setTickets(mapped);\n    }).catch(() => {\n      setFeedback({\n        type: 'error',\n        message: 'Erro de conexão ao buscar tickets. Verifique o backend.'\n      });\n    });\n  }, [updating]);\n  const handleStatusChange = async (ticket, newStatus) => {\n    setUpdating(ticket.id);\n    try {\n      const res = await fetch(`${process.env.REACT_APP_API_URL}/tickets_api.php`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          id: ticket.id - 1,\n          status: newStatus\n        })\n      });\n      if (res.ok) {\n        setFeedback({\n          type: 'success',\n          message: 'Status atualizado com sucesso!'\n        });\n      } else {\n        const data = await res.json().catch(() => ({}));\n        setFeedback({\n          type: 'error',\n          message: data.error || 'Erro ao atualizar status.'\n        });\n      }\n    } catch (e) {\n      setFeedback({\n        type: 'error',\n        message: 'Erro de conexão ao atualizar status.'\n      });\n    }\n    setTimeout(() => setFeedback(null), 2500);\n    setUpdating(null);\n    if (onStatusChange) onStatusChange();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ticket-list\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Support Tickets\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }, this), feedback && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: feedback.type === 'success' ? '#e8f5e9' : '#ffebee',\n        color: feedback.type === 'success' ? '#388e3c' : '#d32f2f',\n        padding: '8px 16px',\n        borderRadius: 6,\n        marginBottom: 10,\n        fontWeight: 500\n      },\n      children: feedback.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: tickets.map(ticket => /*#__PURE__*/_jsxDEV(\"li\", {\n        className: `ticket-item ${ticket.status.toLowerCase()}`,\n        onClick: () => onSelect(ticket),\n        style: {\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: ticket.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Status: \", ticket.status]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: ticket.status,\n          onChange: e => handleStatusChange(ticket, e.target.value),\n          disabled: updating === ticket.id,\n          children: statusOptions.map(opt => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: opt.value,\n            children: opt.label\n          }, opt.value, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Nome:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 28\n          }, this), \" \", ticket.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Email:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 28\n          }, this), \" \", ticket.email]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 25\n        }, this)]\n      }, ticket.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }, this);\n};\n_s(TicketList, \"/NXzm6lTMJQlzUqjhAbVA6AZNWk=\");\n_c = TicketList;\nexport default TicketList;\nvar _c;\n$RefreshReg$(_c, \"TicketList\");","map":{"version":3,"names":["React","useEffect","useState","jsxDEV","_jsxDEV","statusOptions","value","label","TicketList","onSelect","onStatusChange","_s","tickets","setTickets","updating","setUpdating","feedback","setFeedback","fetch","process","env","REACT_APP_API_URL","credentials","then","res","ok","Error","json","data","mapped","map","t","idx","status","id","title","subject","name","email","message","telefone","catch","type","handleStatusChange","ticket","newStatus","method","headers","body","JSON","stringify","error","e","setTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","background","color","padding","borderRadius","marginBottom","fontWeight","toLowerCase","onClick","cursor","onChange","target","disabled","opt","_c","$RefreshReg$"],"sources":["E:/Helpdesk/HelpDesk/helpdesk-frontend/src/components/TicketList.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport './TicketList.css';\n\nexport interface Ticket {\n    id: number;\n    title: string;\n    status: string;\n    name?: string;\n    email?: string;\n    subject?: string;\n    message?: string;\n    telefone?: string;\n}\n\ninterface TicketListProps {\n    onSelect: (ticket: Ticket) => void;\n    onStatusChange?: () => void;\n}\n\nconst statusOptions = [\n    { value: 'nao_aberto', label: 'Não aberto' },\n    { value: 'em_analise', label: 'Em análise' },\n    { value: 'resolvido', label: 'Resolvido' },\n];\n\nconst TicketList: React.FC<TicketListProps> = ({ onSelect, onStatusChange }) => {\n    const [tickets, setTickets] = useState<Ticket[]>([]);\n    const [updating, setUpdating] = useState<number | null>(null);\n    const [feedback, setFeedback] = useState<{type: 'success'|'error', message: string}|null>(null);\n\n    useEffect(() => {\n        fetch(`${process.env.REACT_APP_API_URL}/tickets_api.php`, { credentials: 'include' })\n            .then(res => {\n                if (!res.ok) throw new Error('Erro ao buscar tickets');\n                return res.json();\n            })\n            .then(data => {\n                const mapped = (data || []).map((t: any, idx: number) => {\n                    let status = t.status;\n                    if (!status || status === 'Desconhecido') status = 'nao_aberto';\n                    return {\n                        id: idx + 1,\n                        title: t.subject || t.title || 'Sem título',\n                        status,\n                        name: t.name,\n                        email: t.email,\n                        subject: t.subject,\n                        message: t.message,\n                        telefone: t.telefone,\n                    };\n                });\n                setTickets(mapped);\n            })\n            .catch(() => {\n                setFeedback({type: 'error', message: 'Erro de conexão ao buscar tickets. Verifique o backend.'});\n            });\n    }, [updating]);\n\n    const handleStatusChange = async (ticket: Ticket, newStatus: string) => {\n        setUpdating(ticket.id);\n        try {\n            const res = await fetch(`${process.env.REACT_APP_API_URL}/tickets_api.php`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                credentials: 'include',\n                body: JSON.stringify({ id: ticket.id - 1, status: newStatus })\n            });\n            if (res.ok) {\n                setFeedback({type: 'success', message: 'Status atualizado com sucesso!'});\n            } else {\n                const data = await res.json().catch(() => ({}));\n                setFeedback({type: 'error', message: data.error || 'Erro ao atualizar status.'});\n            }\n        } catch (e) {\n            setFeedback({type: 'error', message: 'Erro de conexão ao atualizar status.'});\n        }\n        setTimeout(() => setFeedback(null), 2500);\n        setUpdating(null);\n        if (onStatusChange) onStatusChange();\n    };\n\n    return (\n        <div className=\"ticket-list\">\n            <h2>Support Tickets</h2>\n            {feedback && (\n                <div style={{\n                    background: feedback.type === 'success' ? '#e8f5e9' : '#ffebee',\n                    color: feedback.type === 'success' ? '#388e3c' : '#d32f2f',\n                    padding: '8px 16px',\n                    borderRadius: 6,\n                    marginBottom: 10,\n                    fontWeight: 500\n                }}>{feedback.message}</div>\n            )}\n            <ul>\n                {tickets.map(ticket => (\n                    <li\n                        key={ticket.id}\n                        className={`ticket-item ${ticket.status.toLowerCase()}`}\n                        onClick={() => onSelect(ticket)}\n                        style={{ cursor: 'pointer' }}\n                    >\n                        <h3>{ticket.title}</h3>\n                        <p>Status: {ticket.status}</p>\n                        <select\n                            value={ticket.status}\n                            onChange={e => handleStatusChange(ticket, e.target.value)}\n                            disabled={updating === ticket.id}\n                        >\n                            {statusOptions.map(opt => (\n                                <option key={opt.value} value={opt.value}>{opt.label}</option>\n                            ))}\n                        </select>\n                        <p><strong>Nome:</strong> {ticket.name}</p>\n                        <p><strong>Email:</strong> {ticket.email}</p>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n};\n\nexport default TicketList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}